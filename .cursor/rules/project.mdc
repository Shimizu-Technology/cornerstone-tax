---
description: Core project context and guiding principles for Cornerstone Accounting
alwaysApply: true
---

# Cornerstone Accounting Project

## What This Project Is
A unified digital platform for Cornerstone Accounting & Business Services (Guam):
- Public website (marketing, services, contact)
- Digital client intake form (online + iPad kiosk mode)
- Admin dashboard for workflow tracking, time tracking, and audit trail
- AI-powered transmittal generator (future phase)

## Tech Stack
- **Frontend**: React + Vite + Tailwind CSS
- **Main Backend**: Ruby on Rails (API mode)
- **AI Backend**: Python + FastAPI (for transmittal AI, shares same database)
- **Database**: 
  - Development: Local PostgreSQL
  - Production: PostgreSQL on Neon (shared between Rails and FastAPI)
- **Auth**: Clerk
- **File Storage**: AWS S3 (private, pre-signed URLs)
- **Email**: Resend
- **SMS**: ClickSend
- **Hosting**: Netlify (frontend), Render (backend services)

## Guiding Principles (ALWAYS FOLLOW)

### 1. Mobile-First, Responsive Always
- Every feature must work on mobile AND desktop from day one
- Minimum 44x44px touch targets (48px for primary actions)
- Test on real devices, not just browser resize
- Mobile is NOT a "Phase 2" thing

### 2. Ease of Use Over Feature Richness
- If users need instructions, we've failed
- Reduce clicks, reduce friction, reduce cognitive load
- Design for the least technical user

### 3. Do It Right, Not Quick
- Prefer proper solutions over bandaid fixes
- Build for the long run, not just "make it work now"
- Good architecture upfront > technical debt later

### 4. Configurability Over Hardcoding
- Workflow stages are admin-configurable (stored in database)
- Time tracking categories are admin-configurable
- Avoid hardcoding values that might change

## User Roles
- **Admin**: Full access, user management, settings
- **Employee**: Workflow management, time tracking, assigned returns
- **Client**: View own return status, upload documents (future)

## Key Domain Concepts
- **Client**: Person who submits intake form for tax preparation
- **Tax Return**: The workflow item being tracked through stages
- **Workflow Stage**: Configurable status (intake_received â†’ complete)
- **Workflow Event**: Tax return-specific audit log (status changes, assignments, notes, income sources)
- **Audit Log**: General-purpose audit log (client edits, time entries, user management)
- **Time Entry**: Employee hours logged against categories
- **Income Source**: W-2, 1099, business income, etc. linked to a tax return
- **Transmittal**: Document sent with tax return materials (future)

## Audit Logging Strategy
We have TWO audit systems for different purposes:
1. **workflow_events** - Tax return specific actions (shows on tax return detail page)
   - Status changes, assignments, notes updates, income source changes
2. **audit_logs** - General system-wide actions (shows on global Activity page)
   - Client profile edits, time entries, user management

## Current Build Status
- âœ… Public website (Home, About, Services, Contact)
- âœ… Client intake form with iPad kiosk mode
- âœ… Admin dashboard with client/return management
- âœ… Workflow tracking with configurable stages
- âœ… Time tracking with daily/weekly views
- âœ… User management (invite-only system)
- âœ… Audit logging for all actions
- ðŸ”œ Document upload with S3
- ðŸ”œ Client portal
- ðŸ”œ AI transmittal generator
